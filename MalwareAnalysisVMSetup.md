# ðŸ§ª Windows Malware Analysis Lab Setup (VMware + Chocolatey)

This guide sets up a **malware analysis lab in a Windows VM** using Chocolatey to automate tool installation.

---

## ðŸ”§ Requirements

- VMware Workstation / Player installed
- Windows 10 ISO
- Virtual Machine created with:
  - 2+ CPU cores
  - 4â€“8 GB RAM
  - 60 GB HDD
  - Host-Only or NAT network (no internet access)
- PowerShell (Administrator access)

---

## ðŸ“¦ Tools Installed via Chocolatey

| Tool            | Description                          |
|-----------------|--------------------------------------|
| Procmon         | Monitors file, registry, and process |
| Process Hacker  | Advanced task manager                |
| Process Explorer| Inspect running processes            |
| Wireshark       | Network sniffer                      |
| PE-bear         | PE file analyzer                     |
| Sysinternals    | Microsoft diagnostic tools           |
| RegShot         | Registry change comparison           |
| dnSpy           | .NET decompiler                      |
| Ghidra          | Reverse engineering suite            |
| Python3         | Scripting environment                |
| 7-Zip           | File extraction                      |
| Autoruns        | Auto-start item inspection           |
| dotPeek         | .NET decompiler                      |
| Notepad++       | Text/code editor                     |

---

## ðŸš€ Setup Instructions

### Step 1: Install Chocolatey

Open **PowerShell as Administrator** and run:


---

## ðŸ“œ `choco-setup.ps1`

```powershell
# choco-setup.ps1 â€” Install malware analysis tools using Chocolatey

Set-ExecutionPolicy Bypass -Scope Process -Force
choco feature enable -n allowGlobalConfirmation

Write-Host "Disabling Windows Defender..."
Try {
    Set-MpPreference -DisableRealtimeMonitoring $true
} Catch {
    Write-Host "Windows Defender not available or already disabled."
}

# --- Install Core Tools ---
choco install pe-bear
choco install wireshark
choco install sysinternals
choco install processhacker
choco install procmon
choco install process-explorer
choco install autoruns
choco install dnspy
choco install python3
choco install notepadplusplus
choco install 7zip
choco install ghidra
choco install dotpeek

# --- Optional Extras ---
choco install regshot
choco install ollydbg

# --- Disable telemetry services ---
Write-Host "Disabling telemetry and update services..."
Try {
    Stop-Service DiagTrack -ErrorAction SilentlyContinue
    Set-Service DiagTrack -StartupType Disabled
} Catch {}

Try {
    Stop-Service wuauserv -ErrorAction SilentlyContinue
    Set-Service wuauserv -StartupType Disabled
} Catch {}

Write-Host "`nâœ… Malware Lab Setup Complete."
Write-Host "ðŸ“Œ Take a VM snapshot now!"


```powershell
Set-ExecutionPolicy Bypass -Scope Process -Force
[System.Net.ServicePointManager]::SecurityProtocol = [System.Net.SecurityProtocolType]::Tls12
iex ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))
